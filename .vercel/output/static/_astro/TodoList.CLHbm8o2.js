import{e as $,r as j,m as ee,i as ue,f as fe,g as he,j as A,k as te,t as ge,l as me,n as ve,w as B,p as pe,q as be,a as P,s as w,u as T,v as i,x as M,y as F,z as U,A as ye,B as Se,C as _e,F as Te,D as xe,o as Q,E as we}from"./runtime-dom.esm-bundler.D5Xpk69B.js";import{_ as oe}from"./_plugin-vue_export-helper.DlAUqK2U.js";/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let se;const D=e=>se=e,re=Symbol();function H(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var L;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(L||(L={}));function K(){const e=$(!0),t=e.run(()=>j({}));let s=[],o=[];const c=ee({install(n){D(c),c._a=n,n.provide(re,c),n.config.globalProperties.$pinia=c,o.forEach(r=>s.push(r)),o=[]},use(n){return this._a?s.push(n):o.push(n),this},_p:s,_a:null,_e:e,_s:new Map,state:t});return c}const ne=()=>{};function X(e,t,s,o=ne){e.push(t);const c=()=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),o())};return!s&&me()&&ve(c),c}function I(e,...t){e.slice().forEach(s=>{s(...t)})}const Ce=e=>e(),Y=Symbol(),z=Symbol();function W(e,t){e instanceof Map&&t instanceof Map?t.forEach((s,o)=>e.set(o,s)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const s in t){if(!t.hasOwnProperty(s))continue;const o=t[s],c=e[s];H(c)&&H(o)&&e.hasOwnProperty(s)&&!A(o)&&!te(o)?e[s]=W(c,o):e[s]=o}return e}const ke=Symbol();function Ie(e){return!H(e)||!e.hasOwnProperty(ke)}const{assign:x}=Object;function Pe(e){return!!(A(e)&&e.effect)}function je(e,t,s,o){const{state:c,actions:n,getters:r}=t,f=s.state.value[e];let m;function v(){f||(s.state.value[e]=c?c():{});const b=be(s.state.value[e]);return x(b,n,Object.keys(r||{}).reduce((y,S)=>(y[S]=ee(P(()=>{D(s);const _=s._s.get(e);return r[S].call(_,_)})),y),{}))}return m=ae(e,v,t,s,o,!0),m}function ae(e,t,s={},o,c,n){let r;const f=x({actions:{}},s),m={deep:!0};let v,b,y=[],S=[],_;const h=o.state.value[e];!n&&!h&&(o.state.value[e]={}),j({});let C;function E(l){let a;v=b=!1,typeof l=="function"?(l(o.state.value[e]),a={type:L.patchFunction,storeId:e,events:_}):(W(o.state.value[e],l),a={type:L.patchObject,payload:l,storeId:e,events:_});const d=C=Symbol();pe().then(()=>{C===d&&(v=!0)}),b=!0,I(y,a,o.state.value[e])}const p=n?function(){const{state:a}=s,d=a?a():{};this.$patch(k=>{x(k,d)})}:ne;function N(){r.stop(),y=[],S=[],o._s.delete(e)}const J=(l,a="")=>{if(Y in l)return l[z]=a,l;const d=function(){D(o);const k=Array.from(arguments),q=[],R=[];function ie(u){q.push(u)}function de(u){R.push(u)}I(S,{args:k,name:d[z],store:g,after:ie,onError:de});let V;try{V=l.apply(this&&this.$id===e?this:g,k)}catch(u){throw I(R,u),u}return V instanceof Promise?V.then(u=>(I(q,u),u)).catch(u=>(I(R,u),Promise.reject(u))):(I(q,V),V)};return d[Y]=!0,d[z]=a,d},le={_p:o,$id:e,$onAction:X.bind(null,S),$patch:E,$reset:p,$subscribe(l,a={}){const d=X(y,l,a.detached,()=>k()),k=r.run(()=>B(()=>o.state.value[e],q=>{(a.flush==="sync"?b:v)&&l({storeId:e,type:L.direct,events:_},q)},x({},m,a)));return d},$dispose:N},g=he(le);o._s.set(e,g);const O=(o._a&&o._a.runWithContext||Ce)(()=>o._e.run(()=>(r=$()).run(()=>t({action:J}))));for(const l in O){const a=O[l];if(A(a)&&!Pe(a)||te(a))n||(h&&Ie(a)&&(A(a)?a.value=h[l]:W(a,h[l])),o.state.value[e][l]=a);else if(typeof a=="function"){const d=J(a,l);O[l]=d,f.actions[l]=a}}return x(g,O),x(ge(g),O),Object.defineProperty(g,"$state",{get:()=>o.state.value[e],set:l=>{E(a=>{x(a,l)})}}),o._p.forEach(l=>{x(g,r.run(()=>l({store:g,app:o._a,pinia:o,options:f})))}),h&&n&&s.hydrate&&s.hydrate(g.$state,h),v=!0,b=!0,g}/*! #__NO_SIDE_EFFECTS__ */function ce(e,t,s){let o;const c=typeof t=="function";o=c?s:t;function n(r,f){const m=fe();return r=r||(m?ue(re,null):null),r&&D(r),r=se,r._s.has(e)||(c?ae(e,t,o,r):je(e,o,r)),r._s.get(e)}return n.$id=e,n}const Z=ce("todo",{state:()=>({todos:[]}),getters:{activeTodos:e=>e.todos.filter(t=>!t.completed),completedTodos:e=>e.todos.filter(t=>t.completed)},actions:{addTodo(e){const t={id:Date.now().toString(),text:e,completed:!1,createdAt:new Date};this.todos.push(t),this.saveTodos()},toggleTodo(e){const t=this.todos.find(s=>s.id===e);t&&(t.completed=!t.completed,this.saveTodos())},deleteTodo(e){this.todos=this.todos.filter(t=>t.id!==e),this.saveTodos()},clearCompleted(){this.todos=this.todos.filter(e=>!e.completed),this.saveTodos()},saveTodos(){localStorage.setItem("todos",JSON.stringify(this.todos))},loadTodos(){const e=localStorage.getItem("todos");if(e)try{this.todos=JSON.parse(e)}catch(t){console.error("Error parsing saved todos:",t),this.todos=[]}}}}),G=ce("storage",{state:()=>({useSqlite:!1}),actions:{setStorageType(e){this.useSqlite=e,localStorage.setItem("todo-storage-preference",e?"sqlite":"local")},loadPreference(){const e=localStorage.getItem("todo-storage-preference");e&&(this.useSqlite=e==="sqlite")}}}),Ee={__name:"TodoItem",props:{todo:{type:Object,required:!0}},emits:["toggle","delete"],setup(e,{expose:t}){t();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},Oe=["checked"];function qe(e,t,s,o,c,n){return T(),w("li",{class:F(["todo-item flex items-center p-3 border rounded transition hover:bg-gray-50",{"bg-green-50":s.todo.completed}])},[i("input",{type:"checkbox",checked:s.todo.completed,onChange:t[0]||(t[0]=r=>e.$emit("toggle")),class:"w-5 h-5 mr-3 rounded focus:ring-blue-500 text-blue-600 border-gray-300"},null,40,Oe),i("span",{class:F(["flex-1",{"line-through text-gray-400":s.todo.completed}])},M(s.todo.text),3),i("button",{onClick:t[1]||(t[1]=r=>e.$emit("delete")),class:"ml-2 text-red-500 hover:text-red-700 focus:outline-none","aria-label":"Delete todo"},t[2]||(t[2]=[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},[i("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),i("path",{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})],-1)]))],2)}const Ve=oe(Ee,[["render",qe],["__scopeId","data-v-046d4bb2"]]),Le={__name:"TodoList",setup(e,{expose:t}){t();const s=K(),o=Z(s),c=G(s),n=P(()=>c.useSqlite?sqliteTodoStore:o),r=j(""),f=P(()=>n.value.todos),m=P(()=>n.value.activeTodos.length),v=P(()=>f.value.length-m.value),b=async()=>{r.value.trim()&&(await n.value.addTodo(r.value.trim()),r.value="")},y=async p=>{await n.value.toggleTodo(p)},S=async p=>{await n.value.deleteTodo(p)},_=async()=>{await n.value.clearCompleted()},h=j(!1),C=j("");B(()=>c.useSqlite,async p=>{h.value=!1,C.value="";try{await n.value.loadTodos()}catch(N){console.error("Error loading todos after storage change:",N),p===!0&&(h.value=!0,C.value="Failed to load todos from API. Server-side rendering may not be enabled.",c.setStorageType(!1))}}),Q(async()=>{c.setStorageType(!1);try{await n.value.loadTodos()}catch(p){console.error("Error loading initial todos:",p)}});const E={pinia:s,localTodoStore:o,storageStore:c,todoStore:n,newTodo:r,todos:f,activeTodosCount:m,completedTodosCount:v,addTodo:b,toggleTodo:y,deleteTodo:S,clearCompleted:_,apiError:h,apiErrorMessage:C,ref:j,computed:P,onMounted:Q,watch:B,get useTodoStore(){return Z},get useStorageStore(){return G},TodoItem:Ve,get createPinia(){return K}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},Me={class:"todo-list"},Ae={class:"storage-switcher mb-4 p-4 bg-gray-100 rounded-lg"},De={class:"mt-2 text-sm text-gray-600"},Ne={key:0,class:"mt-2 text-xs text-amber-600"},Re={key:0,class:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded"},ze={class:"mb-6"},Be={key:1,class:"text-center py-6 text-gray-500"},Fe={key:2},He={class:"space-y-2"},We={class:"mt-4 flex justify-between text-sm text-gray-600"},Je=["disabled"];function Ue(e,t,s,o,c,n){return T(),w("div",Me,[i("div",Ae,[t[1]||(t[1]=i("h3",{class:"text-lg font-medium mb-2"},"Storage Mode",-1)),i("p",De,M(e.useSqlite?"Using server API with SQLite backend":"Using localStorage for browser-based storage"),1),e.useSqlite&&e.isPreview?(T(),w("p",Ne," Note: SQLite mode requires Astro's SSR enabled. If you're seeing errors, you may be in static mode. ")):U("",!0)]),o.apiError?(T(),w("div",Re,[i("p",null,M(o.apiErrorMessage),1),t[2]||(t[2]=i("p",{class:"text-sm mt-1"},"Defaulting to localStorage mode.",-1))])):U("",!0),i("div",ze,[i("form",{onSubmit:ye(o.addTodo,["prevent"]),class:"flex gap-2"},[Se(i("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.newTodo=r),placeholder:"Add a new task...",class:"flex-1 px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[_e,o.newTodo]]),t[3]||(t[3]=i("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition"}," Add ",-1))],32)]),o.todos.length?(T(),w("div",Fe,[i("ul",He,[(T(!0),w(Te,null,xe(o.todos,r=>(T(),we(o.TodoItem,{key:r.id,todo:r,onToggle:f=>o.toggleTodo(r.id),onDelete:f=>o.deleteTodo(r.id)},null,8,["todo","onToggle","onDelete"]))),128))]),i("div",We,[i("span",null,M(o.activeTodosCount)+" items left",1),i("button",{onClick:o.clearCompleted,class:F(["text-blue-500 hover:underline focus:outline-none",{"opacity-50 cursor-not-allowed":!o.completedTodosCount}]),disabled:!o.completedTodosCount}," Clear completed ",10,Je)])])):(T(),w("div",Be," No tasks yet. Add your first task above! "))])}const Ye=oe(Le,[["render",Ue],["__scopeId","data-v-a3914654"]]);export{Ye as default};
