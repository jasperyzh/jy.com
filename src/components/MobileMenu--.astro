<div class="mobile-menu-container">
  <button id="mobile-menu-toggle" class="mobile-menu-toggle">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>

  <nav id="mobile-menu-overlay" class="mobile-menu-overlay">
    <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">Pages</a></li>
      <li><a href="#">Components</a></li>
    </ul>
  </nav>
</div>

<style is:inline>
  .mobile-menu-container {
    display: none; /* Hidden by default, shown on mobile */
  }

  .mobile-menu-toggle {
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    width: 30px;
    height: 25px;
    padding: 0;

    position: relative;
    z-index: 1000;
  }

  .mobile-menu-toggle .icon-bar {
    display: block;
    width: 100%;
    height: 3px;
    background-color: var(--text-dark);
    transition: all 0.3s ease-in-out;
  }

  .mobile-menu-overlay {
    display: none; /* Hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--background-light);
    z-index: 999;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    opacity: 0;
    transform: translateY(-100%);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
  }

  .mobile-menu-overlay.open {
    display: flex;
    opacity: 1;
    transform: translateY(0);
  }

  .mobile-menu-overlay ul {
    list-style: none;
    padding: 0;
    text-align: center;
  }

  .mobile-menu-overlay ul li {
    margin: 1.5rem 0;
  }

  .mobile-menu-overlay ul li a {
    color: var(--text-dark);
    text-decoration: none;
    font-size: 2rem;
    font-weight: bold;
  }

  /* Desktop styles - hide mobile menu */
  @media (min-width: 768px) {
    .mobile-menu-container {
      display: none;
    }
    header nav {
      display: block !important; /* Ensure desktop nav is visible */
    }
  }

  /* Mobile styles - show mobile menu toggle, hide desktop nav */
  @media (max-width: 767px) {
    .mobile-menu-container {
      display: block;
    }
    header nav {
      display: none; /* Hide desktop nav on mobile */
    }
  }
</style>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleButton = document.getElementById("mobile-menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu-overlay");

    if (toggleButton && mobileMenu) {
      toggleButton.addEventListener("click", () => {
        if (mobileMenu.classList.contains("open")) {
          mobileMenu.classList.remove("open");
          toggleButton.classList.remove("open");
          // Wait for the transition to finish before hiding the element completely
          mobileMenu.addEventListener('transitionend', function handler() {
            mobileMenu.style.display = 'none';
            mobileMenu.removeEventListener('transitionend', handler);
          });
        } else {
          mobileMenu.style.display = 'flex'; // Make it visible before animating
          // Force reflow to ensure transition applies
          void mobileMenu.offsetWidth;
          mobileMenu.classList.add("open");
          toggleButton.classList.add("open");
        }
      });

      // Close menu when a link is clicked
      mobileMenu.querySelectorAll("a").forEach(link => {
        link.addEventListener("click", () => {
          if (mobileMenu.classList.contains("open")) {
            mobileMenu.classList.remove("open");
            toggleButton.classList.remove("open");
            mobileMenu.addEventListener('transitionend', function handler() {
              mobileMenu.style.display = 'none';
              mobileMenu.removeEventListener('transitionend', handler);
            });
          }
        });
      });
    }
  });
</script>
