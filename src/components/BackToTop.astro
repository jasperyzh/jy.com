---
// Floating button for quick access to top of page
// Simple, essential, vanilla JS with classless CSS
---

<button id="backToTop" class="btn--toggle" aria-label="Scroll to top"
  >Top</button
>

<script is:inline>
  (() => {
    const button = document.getElementById("backToTop");
    if (!button) return;

    const SCROLL_THRESHOLD = 100;
    let ticking = false;

    const updateVisibility = () => {
      const isVisible = window.scrollY > SCROLL_THRESHOLD;
      if (isVisible) {
        button.setAttribute("data-visible", "");
      } else {
        button.removeAttribute("data-visible");
      }
      ticking = false;
    };

    const handleScroll = () => {
      if (!ticking) {
        window.requestAnimationFrame(updateVisibility);
        ticking = true;
      }
    };

    window.addEventListener("scroll", handleScroll, { passive: true });
    button.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    updateVisibility();
  })();
</script>

<style is:global>
  .btn--toggle--fadein_inview,
  #backToTop {
    --opacity-hidden: 0;
    --opacity-visible: 0.6;
    --opacity-hover: 1;
    --transition-duration: 0.3s;

    position: relative;
    z-index: 1000;
    opacity: var(--opacity-hidden);
    visibility: hidden;
    transition:
      opacity var(--transition-duration) ease,
      visibility var(--transition-duration) ease;
    /* border: none; */
    /* cursor: pointer; */
  }

  #backToTop[data-visible] {
    opacity: var(--opacity-visible);
    visibility: visible;
  }

  #backToTop[data-visible]:hover {
    opacity: var(--opacity-hover);
  }
</style>
