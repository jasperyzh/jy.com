---
import "@/styles/tailwind--.css";

import LayoutBase from "./LayoutBase.astro";
import SiteHeader from "./SiteHeader.astro";
import SiteFooter from "./SiteFooter.astro";

import Darkmode from "@/components/DarkMode.astro";
import BackToTop from "@/components/BackToTop.astro";
import HotkeyManager from "@/components/HotkeyManager.astro";

interface Props {
  title?: string | undefined;
  description?: string | undefined;
  empty_canvas?: boolean;
}

const { title, description, empty_canvas = false } = Astro.props as Props;
---

<LayoutBase title={title} description={description}>
  {empty_canvas ? (
    <>
      <Darkmode />
      <HotkeyManager />
      <BackToTop />
    </>
  ) : (
    <SiteHeader>
      <Darkmode />
      <HotkeyManager />
    </SiteHeader>
  )}

  <slot />

  {!empty_canvas && (
    <SiteFooter>
      <BackToTop />
    </SiteFooter>
  )}
</LayoutBase>


<script>
  // Register spacebar hotkey for recording toggle
  function initHotkeys() {
    if (window.hotkeyManager) {
      // Global hotkeys
      /* window.hotkeyManager.register(
        " ",
        "Toggle recording",
        () => {
          toggleRecord();
        },
        true
      ); */

      // Console-only hotkeys (only work when console is open)
      window.hotkeyManager.register(
        "1",
        "Go to homepage",
        () => {
          window.location.href = "/";
        },
        true,
        {},
        true
      ); // consoleOnly = true
 window.hotkeyManager.register(
        "2",
        "Go to toolstack--",
        () => {
          window.location.href = "/toolstack--";
        },
        true,
        {},
        true
      ); // consoleOnly = true
      // Add more console hotkeys here:
      // window.hotkeyManager.register('2', 'Action 2', () => { ... }, true, {}, true);
      // window.hotkeyManager.register('3', 'Action 3', () => { ... }, true, {}, true);
      // ... and so on
    } else {
      // Retry if hotkeyManager isn't ready yet
      setTimeout(initHotkeys, 100);
    }
  }

  // Initialize hotkeys when DOM is ready
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initHotkeys);
  } else {
    initHotkeys();
  }
</script>
